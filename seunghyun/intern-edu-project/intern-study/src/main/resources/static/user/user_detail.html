<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>사용자 정보</title>
</head>
<body class="container p-4">
<h2>내정보</h2>
<div id="userInfo" class="border p-3 bg-light">내 정보</div>

<div class="mt-3">
  <button class="btn btn-secondary" onclick="goBack()">돌아가기</button>
  <button class="btn btn-outline-danger float-right" onclick="logout()">로그아웃</button>
</div>

</body>

<script src="/js/common.js"></script>
<script>
  // 뒤로 가기
  function goBack() {
    history.back();
  }

  // 로그아웃 처리 (세션 제거는 서버에서 여기선 로컬 스토리지만 제거)
  function logout() {
    localStorage.clear();
    location.href = "/login.html";
  }

  // 사용자 정보 조회
  async function loadUserInfo() {
    const userId = localStorage.getItem("userId");

    if (!userId) {
      await AlertUtil.showError("로그인 정보가 없습니다. 다시 로그인해 주세요.");
      location.href = "/login.html";
      return;
    }

    const user = await ApiUtil.get(`/api/user/${userId}`);

    if (!user) return; // ApiUtil 내부에서 showError 처리됨

    const html = `
      <div><strong>아이디</strong> : ${user.userId}</div>
      <div><strong>이름</strong> : ${user.username}</div>
      <div><strong>이메일</strong> : ${user.email}</div>
      <div><strong>권한</strong> : ${user.role}</div>
      <div><strong>사용 여부</strong> : ${(user.isActive === true) ? "Y" : "N"}</div>
    `;

    document.getElementById("userInfo").innerHTML = html;
  }

  document.addEventListener("DOMContentLoaded", function () {
    // common.js 호출 이후 실행되도록
    setTimeout(loadUserInfo, 100);
  });

</script>
</html>
